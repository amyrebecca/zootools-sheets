<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css" />
    <?!= include('styles'); ?>
  </head>
  <body class="sidebar">
    <div class="block">
      <h1>Pie Chart Helper</h1>
    </div>
    <div class="block">
      <p class="instructions">You may change the pie chart variable below, then press <code class="button-like action">Chart</code> to draw or redraw the plot. Use <code class="button-like action">Reset</code> to reset your variable selection.<strong>Select if the pie chart variable is first row or the first column. If it is the first row, then the first column will be used as the pie section labels. If it is the first column, then the first row will be used as the pie section labels.</strong></p>
      <div data-ui="status" style="display: block; margin: 1em; text-align: center;"></div>
    </div>
    <div style="text-align: center; width: 100%;"><p><button class="button action" onclick="resetDOMState()">Reset</button></p></div>
    <div class="block">
      <fieldset class="variable-orientation">
      <legend>Select the variable format of your data:</legend>
        <label>
          <input type="radio" id="first-row-orientation" name="variable-orientation" value="first-row" onclick="getFirstRowVariables('variableDefs', addVariableOptions)" />
          First row
        </label>
        <label>
          <input type="radio" id="first-column-orientation" name="variable-orientation" value="first-column" onclick="getFirstColumnVariables('variableDefs', addVariableOptions)" />
          First column
        </label>
      </fieldset>
      <fieldset>
      <legend>Pie Chart Variable</legend>
      <div class="block form-group collapse" id="xDef">
        <select id="xVar" data-select="variable" style="width: 100%;" disabled>
        </select>
      </div>
      </fieldset>
      <fieldset>
      <legend>Choose which pie section label to use (defaults to use all)</legend>
      <div id="pie-section-labels" class="block form-group collapse">
      </div>
      </fieldset>
    </div>
    <div id="chart-preview" style="width: 100%"></div>
    <div class="action-button-bar" style="text-align: center; ">
      <div data-ui="status" style="display: block; margin: 1em;"></div>
      <div class="inline-button-block">
        <button type="button" id="updateBtn" class="button action" onclick="clientChangeSelection()" disabled>Chart</button>
        <button type="button" id="sendToSheetBtn" class="button create" onclick="clientSendToSheet()" disabled>Send to Sheet</button>
        <button type="button" class="button" onclick="google.script.host.close()">Close</button>
      </div>
    </div>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <?!= include('pie-script'); ?>
  </body>
</html>
