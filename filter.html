<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css" />
    <?!= include('styles'); ?>
  </head>
  <body class="sidebar">
    <div class="block">
      <h1>Data Filter</h1>
    </div>
    <div class="block form-group">
      <p class="instructions">Filter a variable column by a value put into the input below. Then press <code class="button-like action">Filter</code> to insert the filtered data into a new sheet. Use <code class="button-like action">Refresh Data</code> to refresh the available variables in the drop down menu.</p>
      <div data-ui="status" style="display: block; margin: 1em; text-align: center;"></div>
    </div>
    <div style="text-align: center; width: 100%;">
      <button class="button action" onclick="getVariables()">Refresh Data</button>
    </div>

    <? columnDefs = clientGetVariables(); ?>
    <div class="form-group">
      <div>
        <fieldset>
          <legend>First Filter</legend>
          <select id="varName1" data-select="variable" style="width: 100%;">
            <? for(var i = 0; i < columnDefs.length; i++) { ?>
            <option><?= columnDefs[i].name ?></option>
            <? } ?>
          </select>
          <select id="firstFilterOperator">
            <option value="=">=</option>
            <option value="!=">&#8800;</option>
            <option value="<"><</option>
            <option value=">">></option>
            <option value="<=">&#8804;</option>
            <option value=">=">&#8805;</option>
          </select>
          <input type="text" id="firstFilterValue" />
        </fieldset>
      </div>
      <div>
        <p><small>The secondary filter is optional. Select a boolean operator to enable editing of the second filter.</small></p>
        <div style="text-align: center">
          <select id="boolean" onchange="enableSecondFilter()">
            <option disabled selected style="display: none;">select an option</option>
            <option value="and">AND</option>
            <option value="or">OR</option>
          </select>
        </div>
      </div>
      <div>
        <fieldset>
          <legend>Second Filter</legend>
          <select id="varName2" data-select="variable" style="width: 100%;" disabled>
            <? for(var i = 0; i < columnDefs.length; i++) { ?>
            <option><?= columnDefs[i].name ?></option>
            <? } ?>
          </select>
          <select id="secondFilterOperator" disabled>
            <option value="=">=</option>
            <option value="!=">&#8800;</option>
            <option value="<"><</option>
            <option value=">">></option>
            <option value="<=">&#8804;</option>
            <option value=">=">&#8805;</option>
          </select>
          <input type="text" id="secondFilterValue" disabled />
        </fieldset>
      </div>
    </div>
    <div class="block form-group" style="text-align: center; ">
      <div data-ui="status" id="status" style="display: block; margin: 1em;"></div>
      <div class="inline-button-block">
        <button id="filterBtn" class="button action" onclick="getRange()" disabled>Filter</button>
        <button class="button" onclick="google.script.host.close()">Close</button>
      </div>
    </div>      
    <?!= include('filter-script'); ?>
  </body>
</html>
