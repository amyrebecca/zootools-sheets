<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css" />
    <?!= include('styles'); ?>
  </head>
  <body class="sidebar">
    <div class="block">
      <h1>Galaxy Column Chart Helper</h1>
    </div>
    <div class="block">
      <p class="instructions">You may change the galaxy selected below, then press <code class="button-like action">Plot</code> to draw or redraw the plot. Use <code class="button-like action">Refresh Data</code> to refresh the galaxy IDs in the drop down menu. <strong>Galaxy IDs must be in the first column of the spreadsheet.</strong></p>
      <div data-ui="status" style="display: block; margin: 1em; text-align: center;"></div>
    </div>
    <div style="text-align: center; width: 100%;"><button class="button action" onclick="getRowIds()">Refresh Data</button></div>
    <div class="block">
      <? columnDefs = clientGetColumnVariables(); ?>
      <fieldset>
      <legend>Galaxy ID</legend>
      <div class="form-group collapse" id="xDef">
        <select id="xVar" data-select="variable" style="width: 100%;" oninput="updateSelection('x')" disabled>
          <? for(var i = 0; i < columnDefs.length; i++) { ?>
            <option><?= columnDefs[i].name ?></option>
          <? } ?>
        </select>
      </div>
      </fieldset>
    </div>
    <div id="chart-preview" style="width: 100%"></div>
    <div class="action-button-bar" style="text-align: center; ">
      <div data-ui="status" id="status" style="display: block; margin: 1em;"></div>
      <div class="inline-button-block">
        <button type="button" id="updateBtn" class="button action" onclick="clientChangeSelection()" disabled>Plot</button>
        <button type="button" id="sendToSheetBtn" class="button create" onclick="clientSendToSheet()" disabled>Send to Sheet</button>
        <button type="button" class="button" onclick="google.script.host.close()">Close</button>
      </div>
    </div>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    
    <?!= include('galaxy-column-script'); ?>
  </body>
</html>
