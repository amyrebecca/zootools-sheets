<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css" />
    <?!= include('styles'); ?>
  </head>
  <body class="sidebar">
    <div class="block">
      <h1>Summary Stats</h1>
    </div>
    <div class="block form-group">
      <p class="instructions">Calculate summary statistics for selected variables by pressing <code class="button-like action">Calculate</code>. Use <code class="button-like action">Refresh Data</code> to refresh the available variables in the drop down menu.</p>
      <div data-ui="status" style="display: block; margin: 1em; text-align: center;"></div>
    </div>
    <div style="text-align: center; width: 100%;"><button class="button action" onclick="getVariables()">Refresh Data</button></div>
    <div class="preinit" id="resultList" class="hide">

    <div class="block form-group" id="result">
        <table class="stats-table" summary="The minimum, maximum, mean, and standard deviation (row headings) of the selected variable.">
          <colgroup>
            <col style="width: 25%;" />
            <col style="width: 75%;" />
          </colgroup>
          <caption><strong>{{name}}</strong></caption>
          <tbody>
            <tr>
              <th scope="row"><strong>Min</strong></th>
              <td> {{min}}</td>
            </tr>
            <tr>
              <th scope="row"><strong>Max</strong></th>
              <td> {{max}}</td>
            </tr>
            <tr>
              <th scope="row"><strong>Mean</strong></th>
              <td> {{mean}} </td>
            </tr>
            <tr>
              <th scope="row"><strong>Median</strong></th>
              <td> {{median}} </td>
            </tr>
            <tr>
              <th scope="row"><strong>Std. Dev.</strong></th>
              <td> {{stdev}} </td>
            </tr>
          </tbody>
        </table>
    </div>
    </div>
    
    <p />
    <div class="form-group">
      <select id="varName" style="width: 100%;" onchange="checkSelectionState()">
        <option value="" disabled selected style="display: none;">Select the variable</option>
      </select>
    </div> 
    <div class="block form-group" style="text-align: center; ">
      <div data-ui="status" id="status" style="display: block; margin: 1em;"></div>
      <div class="inline-button-block">
        <button id="calcBtn" class="button action" onclick="calculateNew()" disabled>Calculate</button>
        <button id="addToSheetBtn" class="button create" onclick="clientAddToSheet()" disabled>Add to Sheet</button>
        <button class="button" onclick="google.script.host.close()">Close</button>
      </div>
    </div>      
    <?!= include('stats-script'); ?>
  </body>
</html>
