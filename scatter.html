<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css" />
    <?!= include('styles'); ?>
  </head>
  <body class="sidebar">
    <div class="block">
      <h1>Scatter Plot Helper</h1>
    </div>
    <div class="block">
      <p class="instructions">You may change the independent (X) and dependent (Y) variables below, then press <code class="button-like action">Plot</code> to draw or redraw the plot. Use <code class="button-like action">Refresh Data</code> to refresh the available variables in the drop down menus.</p>
      <div data-ui="status" style="display: block; margin: 1em; text-align: center;"></div>
    </div>
    <div style="text-align: center; width: 100%;"><p><button class="button action" onclick="getVariables()">Refresh Data</button></p></div>
    <div class="block">
      <fieldset>
      <legend>X Variable</legend>
      <div class="block form-group collapse" id="xDef">
        <select id="xVar" data-select="variable" style="width: 100%;" disabled>
          <option value="" disabled selected>Select the X variable</option>
        </select>
        <div class="extended" aria-hidden="true" data-options="x">
          <div>
            <p><strong>Axis</strong></p>
            <div style="float: right; width: 50%;"><input type="checkbox" id="logX"><label for="logX">Logarithmic</label></div>
            <div><input type="checkbox" id="invertX" onclick="updateSelection()"/><label for="invertX">Invert</label></div>
          </div>
          <div id="xRange">
            <p><strong>Range</strong></p>
            <p><input type="radio" id="xScaleDefault" name="xScale" checked><label for="xScaleDefault">Auto</label></p>
            <p><input type="radio" id="xScaleSpecific" name="xScale"><label for="xScaleSpecific">Specified</label></p>
            <div style="text-indent: 1.5em;">
              <div style="text-align: justify">
                <input title="Specified range may not be available in chart preview, but will display once sent to the spreadsheet." type="number" pattern="\d*" id="xMin" style="width: 30%; " disabled/>&nbsp; to &nbsp;<input title="Specified range may not be available in chart preview, but will display once sent to the spreadsheet." type="number" pattern="\d*" id="xMax" style="width: 30%; " disabled />
              </div>
            </div>
          </div>
        </div>
        <div class="toggle-buttons">
          <button type="button" class="toggle toggle-more" onclick="toggleVar('x')">More &#9662;</button>
          <button type="button" class="toggle toggle-less" onclick="toggleVar('x')">Less &#9652;</button>
        </div>
      </div>
      </fieldset>
      <fieldset>
      <legend>Y Variable</legend>
      <div class="block form-group collapse" id="yDef">
        <select id="yVar" data-select="variable" style="width: 100%;" disabled>
          <option value="" disabled selected>Select the Y variable</option>
        </select>
        <div class="extended" aria-hidden="true" data-options="y">
          <div>
            <p><strong>Axis</strong></p>
            <div style="float: right; width: 50%;"><input type="checkbox" id="logY"><label for="logY">Logarithmic</label></div>
            <div><input type="checkbox" id="invertY" /><label for="invertY">Invert</label></div>
          </div>
          <div id="xRange">
            <p><strong>Range</strong></p>
            <p><input type="radio" id="yScaleDefault" name="yScale" checked><label for="yScaleDefault">Auto</label></p>
            <p><input type="radio" id="yScaleSpecific" name="yScale"><label for="yScaleSpecific">Specified</label></p>
            <div style="text-indent: 1.5em;">
              <div style="text-align: justify"><input type="number" pattern="\d*" id="yMin" style="width: 30%; " disabled/>&nbsp; to &nbsp;<input type="number" pattern="\d*" id="yMax" style="width: 30%; " disabled /></div>
            </div>
          </div>
        </div>
        <div class="toggle-buttons">
          <button type="button" class="toggle toggle-more" onclick="toggleVar('y')">More &#9662;</button>
          <button type="button" class="toggle toggle-less" onclick="toggleVar('y')">Less &#9652;</button>
        </div>
      </div>
      </fieldset>
    </div>
    <div class="trendline-option-container">
      <label for="trendlineSelector">Trendline</label>
      <select id="trendlineSelector" name="trendline">
        <option value="none" selected>None</option>
        <option value="linear">Linear</option>
        <option value="exponential">Exponential</option>
        <option value="polynomial">Polynomial</option>
      </select>
    </div>
    <div id="chart-preview" style="width: 100%"></div>
    <div class="action-button-bar" style="text-align: center; ">
      <div data-ui="status" style="display: block; margin: 1em;"></div>
      <div class="inline-button-block">
        <button type="button" id="updateBtn" class="button action" onclick="clientChangeSelection()" disabled>Plot</button>
        <button type="button" id="sendToSheetBtn" class="button create" onclick="clientSendToSheet()" disabled>Send to Sheet</button>
        <button type="button" class="button" onclick="google.script.host.close()">Close</button>
      </div>
    </div>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <?!= include('scatter-script'); ?>
  </body>
</html>
